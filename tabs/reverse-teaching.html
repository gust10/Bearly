<div id="mainContent">
  <!-- Screen 1: Material Input -->
  <div class="screen" id="topicScreen">
    <button class="back-btn" onclick="showNav()">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="15 18 9 12 15 6"/></svg> Back
    </button>
    <div class="screen-title" style="margin-top: 15px;">Paste your study material or upload a PDF:</div>
    <div class="input-group">
      <textarea id="topicInput" rows="4" placeholder="Paste your notes, textbook excerpt, or study material here..." style="width: 100%; resize: none; font-family: inherit; font-size: 12px; padding: 8px; border: 1px solid #e2e8f0; border-radius: 8px;"></textarea>
      <div style="display: flex; gap: 8px;">
        <button class="secondary-btn" id="rtUploadPdfBtn" style="flex: 1;">Upload PDF</button>
        <button class="primary-btn" id="submitTopicBtn" style="flex: 1;">Next</button>
      </div>
    </div>
  </div>

  <!-- Screen 2: Explanation Input -->
  <div class="screen" id="explanationScreen">
    <button class="back-btn" onclick="showScreen('topicScreen')">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="15 18 9 12 15 6"/></svg> Back
    </button>
    <div class="screen-title" style="margin-top: 15px;">Now explain what you understood from the material:</div>
    <div class="input-group">
      <textarea id="explanationInput" rows="5" placeholder="Explain the key concepts in your own words..."></textarea>
      <button class="primary-btn" id="submitExplanationBtn">Submit</button>
    </div>
  </div>

  <!-- Screen 3: Feedback & Chat -->
  <div class="screen" id="feedbackScreen">
    <button class="back-btn" id="feedbackBackBtn">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="15 18 9 12 15 6"/></svg> Back
    </button>
    <div class="screen-title" style="margin-top: 15px;">Reverse Teaching Feedback</div>
    <div id="feedbackContent" class="feedback-box"></div>
    
    <div id="feedbackLoading" class="loading" style="display: none; margin: 5px 0;">
      <div class="loading-ring"><div></div><div></div><div></div><div></div></div>
      Thinking...
    </div>

    <div class="chat-input-area" id="chatInputArea" style="display: none;">
      <input type="text" id="chatInput" class="chat-input" placeholder="Continue the discussion...">
      <button id="sendChatBtn" class="send-btn">
        <svg viewBox="0 0 24 24" width="14" height="14" fill="none" stroke="currentColor" stroke-width="2.5"><line x1="22" y1="2" x2="11" y2="13"/><polygon points="22 2 15 22 11 13 2 9 22 2"/></svg>
      </button>
    </div>

    <div class="input-group" style="padding-top: 8px; padding-bottom: 6px;">
      <button class="secondary-btn" id="openFcModalBtn">Generate Flashcards</button>
    </div>
  </div>
</div>

<!-- Flashcard Modal -->
<div class="modal-overlay" id="flashcardModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 1000; align-items: center; justify-content: center;">
  <div class="modal-content" style="background: white; width: 90%; max-width: 320px; padding: 20px; border-radius: 16px; box-shadow: 0 10px 25px rgba(0,0,0,0.2);">
    <div style="font-size: 16px; font-weight: 800; color: #4a4a5a; margin-bottom: 15px; text-align: center;">Generate Flashcards</div>
    
    <div style="margin-bottom: 12px;">
      <label style="font-size: 11px; font-weight: 700; color: #94a3b8; display: block; margin-bottom: 4px;">DECK NAME</label>
      <input type="text" id="fcDeckName" class="input-small" placeholder="e.g. French Verbs" style="width: 100%; padding: 8px; border: 1px solid #e2e8f0; border-radius: 8px;">
    </div>
    
    <div style="margin-bottom: 12px;">
      <label style="font-size: 11px; font-weight: 700; color: #94a3b8; display: block; margin-bottom: 4px;">NUMBER OF CARDS</label>
      <input type="number" id="fcCardCount" value="5" min="1" max="20" style="width: 100%; padding: 8px; border: 1px solid #e2e8f0; border-radius: 8px;">
    </div>
    
    <div style="margin-bottom: 20px;">
      <label id="msgCountLabel" style="font-size: 11px; font-weight: 700; color: #94a3b8; display: block; margin-bottom: 4px;">MESSAGES TO INCLUDE (1-10)</label>
      <input type="number" id="fcMsgCount" value="5" min="1" style="width: 100%; padding: 8px; border: 1px solid #e2e8f0; border-radius: 8px;">
    </div>

    <div style="display: flex; gap: 10px;">
      <button id="cancelFcBtn" style="flex: 1; padding: 10px; border: none; border-radius: 8px; background: #f1f5f9; color: #64748b; font-weight: 700; cursor: pointer;">Cancel</button>
      <button id="generateFcBtn" style="flex: 1; padding: 10px; border: none; border-radius: 8px; background: linear-gradient(135deg, #e8a0bf, #c4b5fd); color: white; font-weight: 800; cursor: pointer;">Generate</button>
    </div>
  </div>
</div>

